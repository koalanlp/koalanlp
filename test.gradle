test {
    failFast true

    // set heap size for the test JVM(s)
    minHeapSize = "1g"
    maxHeapSize = "4g"

    if (project.hasProperty('arch')) {
        def architecture = project.property('arch').toString()

        if (architecture == 'windows') {
            excludes.addAll(['**/KhaiiiTaggerTest.class'])
        } else if (architecture == 'osx') {
            excludes.addAll(['**/UTaggerTaggerTest.class'])
        }
    }
    if (project.hasProperty('noGUI')) {
        excludes.add('**/RhinoOrigin*Test.class')
    }

    useJUnitPlatform {
        includeEngines 'spek2'
    }
}

jacoco {
    toolVersion = "0.8.4"
}

jacocoTestReport {
    reports {
        xml.enabled = true
        html.enabled = true
    }
}

tasks.check.dependsOn tasks.clean
tasks.check.dependsOn tasks.jacocoTestReport